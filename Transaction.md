# 事务

## 事务的ACID原则

- 原子性（Atomic）：一个事务的所有操作要么都做完，要么都不做。
- 一致性（Consistency）：一个事务的执行，不管外部环境如何，结果应该是一致的。
- 隔离性（Isolation）：几个事务在同时执行时，相互之间不受影响。
- 持久性（Durability）：事务完成以后，数据被保存。

## 隔离性（Isolation）面临的几个问题

- 脏读：事务T1读取了事务T2还未提交的数据（可能回滚）
- 不可重复读：事务T1读取到数据为A，事务T2更改了数据为B（已提交），事务T1读取到数据为B。强调因修改引发的不一致问题。
- 幻读：事务T1根据条件读取到的个数为10，事务T2新增或删除了一条数据（已提交），事务T1读取到的个数为11或9。强调因新增或删除引发的不一致问题。

## 事务的隔离级别（递减）

- 串行化（serializable）：事务串行执行，可以解决上面的问题，但存在严重性能问题。
- 重复读（repeatable_read）：保证了事务T2无法修改事务T1读取的数据（未提交）。未解决幻读（无法修改但是可以新增或删除），MySQL默认。
- 读已提交（read_committed）：保证了事务T1不会读到其它事务未提交的数据。未解决不可重复读、幻读。Oracle、SQL server 默认。
- 读未提交（read_uncommitted）：事务T1可能会读取到事务T2新增、删除、修改的数据（未提交）。